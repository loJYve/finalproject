<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mypage">
  
  	<resultMap type="rentalHistory" id="rentaldataMap">
		<id column="RENTAL_ID" property="rentalId"/>
		<result column="RENTAL_DATE" property="rentalDate"/>
		<result column="RETURN_DATE" property="returnDate"/>
		<result column="RENTAL_STATUS" property="status"/>
		<result column="VEHICLE_ID" property="vehicleId"/>
		<result column="MEMBER_ID" property="memberId"/>
		<result column="BOOKING_DATE" property="bookingDate"/>
		<result column="INSURANCE_CODE" property="insuranceCode"/>
	</resultMap>
	
  	<resultMap type="attachment" id="attachmentMap">
		<id column="ATTACHMENT_ID" property="attachmentId"/>
		<result column="ATTACHMENT_TITLE" property="attachmentTitle"/>
		<result column="ATTACHMENT_DATE" property="attchamentDate"/>
		<result column="ORIGINAL_FILENAME" property="originalFilename"/>
		<result column="RENAMED_FILENAME" property="RenamedFilename"/>
	</resultMap>
	
  	<resultMap type="vehicle" id="vehicleMap">
		<id column="VEHICLE_ID" property="vehicleId"/>
		<result column="MODEL" property="model"/>
		<result column="NUMBER_PLATE" property="numberPlate"/>
		<result column="RENTAL_STATUS" property="rentalStatus"/>
		<result column="PRODUCT_YEAR" property="productYear"/>
		<result column="RENTALSHOP_ID" property="rentalshopId"/>
		<result column="ACCIDENT_STATUS" property="accidentStatus"/>
		<result column="PRICE" property="price"/>
		<result column="FUEL" property="fuel"/>
		<result column="BOARDING_PERSONNEL" property="boardingPersonnel"/>
		<result column="VEHICLE_GRADE" property="vehicleGrade"/>
	</resultMap>
	
	<resultMap type="rentalshop" id="rentalshopMap">
		<id column="RENTALSHOP_ID" property="rentalshopId"/>
		<id column="RENTALSHOP_NAME" property="rentalshopName"/>
		<id column="RENTALSHOP_ADDR" property="rentalshopAddr"/>
		<id column="LATITUDE" property="latitude"/>
		<id column="LONGTITUDE" property="longitude"/>
		<id column="BM_MEMBER" property="bmMember"/>
	</resultMap>
	
  
   	<select id="selectRentalData" parameterType="string" resultMap="rentaldataMap">
  		SELECT * FROM RENTAL_HISTORY WHERE MEMBER_ID=#{memberId} AND RENTAL_STATUS='대여중'
  	</select>
  	
   	<select id="selectCarImage" parameterType="_int" resultMap="attachmentMap">
  		SELECT ORIGINAL_FILENAME FROM ATTACHMENT WHERE ATTACHMENT_ID=(SELECT ATTACHMENT_ID FROM VEHICLE_ATTACHMENT WHERE VEHICLE_ID=#{vehicleId})
  	</select>
  	
   	<select id="selectCarData" parameterType="_int" resultMap="vehicleMap">
  		SELECT * FROM VEHICLE WHERE VEHICLE_ID=#{vehicleId}
  	</select>
  	
   	<select id="selectRentalshopData" parameterType="_int" resultMap="rentalshopMap">
  		SELECT * FROM RENTALSHOP WHERE RENTALSHOP_ID=(SELECT RENTALSHOP_ID FROM VEHICLE WHERE VEHICLE_ID=#{vehicleId})
  	</select>
  	
   	<select id="selectrentalHistory" parameterType="string" resultMap="rentaldataMap">
  		SELECT * FROM RENTAL_HISTORY WHERE MEMBER_ID=#{memberId}
  	</select>
  
 
  
  
</mapper>
